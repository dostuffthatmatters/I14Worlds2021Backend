(this.webpackJsonpreact_frontend=this.webpackJsonpreact_frontend||[]).push([[10],{196:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var i=a(43),n=a(0),s=a.n(n),l=a(318),r=s.a.forwardRef((function(e,t){var a=s.a.useState("value"in e?e.value:""),n=Object(i.a)(a,2),r=n[0],o=n[1];return s.a.createElement(l.a,{fullWidth:"fullWidth"in e&&e.fullWidth,className:"className"in e?e.className:"",disabled:"disabled"in e&&e.disabled,multiline:"multiline"in e&&e.multiline,rowsMax:"rowsMax"in e?e.rowsMax:"1",value:r,inputRef:t,onChange:function(t){o(t.target.value),"onChange"in e&&e.onChange(t.target.value)},onKeyDown:function(t){"onTab"in e&&9===t.which?(t.preventDefault(),e.onTab(t.target.value)):"onEnter"in e&&13===t.which?(t.preventDefault(),e.onEnter(t.target.value)):"onEscape"in e&&27===t.which&&(console.log("Triggering Escape"),t.preventDefault(),e.onEscape(t.target.value))},onBlur:function(t){"onBlur"in e&&e.onBlur(t.target.value)},label:e.label})}))},204:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var i=a(43),n=a(0),s=a.n(n),l=a(195),r=a(302),o=a(216),m=function(e){var t=s.a.useState(new Date(1e3*e.timestamp)),a=Object(i.a)(t,2),n=a[0],m=a[1];return s.a.createElement(l.a,{utils:o.a},s.a.createElement(r.a,{className:"className"in e?e.className:"",disabled:"disabled"in e&&e.disabled,margin:"normal",id:"date-picker",label:"Date",format:"dd/MM/yyyy",value:n,onChange:function(t){m(t),"updateTimestamp"in e&&e.updateTimestamp(Math.round(t.getTime()/1e3))},KeyboardButtonProps:{"aria-label":"change date"}}))}},207:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var i=a(43),n=a(0),s=a.n(n),l=a(195),r=a(314),o=a(216),m=function(e){var t=s.a.useState(new Date(1e3*e.timestamp)),a=Object(i.a)(t,2),n=a[0],m=a[1];return s.a.createElement(l.a,{utils:o.a},s.a.createElement(r.a,{className:"className"in e?e.className:"",disabled:"disabled"in e&&e.disabled,margin:"normal",id:"time-picker",label:"Time",value:n,onChange:function(t){m(t),"updateTimestamp"in e&&e.updateTimestamp(Math.round(t.getTime()/1e3))},KeyboardButtonProps:{"aria-label":"change time"}}))}},214:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var i=a(43),n=a(0),s=a.n(n),l=a(297),r=a(313),o=a(304),m=a(317),c=function(e){var t=s.a.useState(e.value),a=Object(i.a)(t,2),n=a[0],c=a[1];return s.a.createElement(l.a,{className:"className"in e?e.className:""},s.a.createElement(r.a,{id:"select-label"},e.label),s.a.createElement(o.a,{disabled:"disabled"in e&&e.disabled,labelId:"select-label",id:"demo-simple-select",value:n,onChange:function(t){c(t.target.value),"onChange"in e&&e.onChange(t.target.value)}},Object.keys(e.selectOptions).map((function(t,a){return s.a.createElement(m.a,{key:a,value:t},e.selectOptions[t])}))))}},215:function(e,t,a){"use strict";var i=a(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(a(0)),s=(0,i(a(27)).default)(n.default.createElement(n.default.Fragment,null,n.default.createElement("path",{d:"M8 9h8v10H8z",opacity:".3"}),n.default.createElement("path",{d:"M15.5 4l-1-1h-5l-1 1H5v2h14V4zM6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9z"})),"DeleteTwoTone");t.default=s},269:function(e,t,a){},270:function(e,t,a){"use strict";var i=a(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(a(0)),s=(0,i(a(27)).default)(n.default.createElement("path",{d:"M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55l-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"}),"FavoriteBorder");t.default=s},271:function(e,t,a){"use strict";var i=a(21);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(a(0)),s=(0,i(a(27)).default)(n.default.createElement("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"}),"CloudUpload");t.default=s},305:function(e,t,a){"use strict";a.r(t);var i=a(37),n=a(38),s=a(40),l=a(39),r=a(34),o=a(41),m=a(0),c=a.n(m),p=a(26),d=a(10),u=(a(269),a(54)),g=a(55),b=a(183),h=a(181),f=a(185),v=a(245),I=a(179),y=a(173),E=a(184),N=a(225),_=a(226),k=a(318),O=a(266),S=a(268),j=a(267),x=a(215),C=a.n(x),T=a(76),w=a.n(T),A=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(l.a)(t).call(this,e))).state={deleteDialogOpen:!1,deleting:!1},a.nameInputRef=c.a.createRef(),a.pushCurrentVersion=a.pushCurrentVersion.bind(Object(r.a)(a)),a.handleNameKeyDown=a.handleNameKeyDown.bind(Object(r.a)(a)),a.handleNameChange=a.handleNameChange.bind(Object(r.a)(a)),a.handleBlur=a.handleBlur.bind(Object(r.a)(a)),a.processDelete=a.processDelete.bind(Object(r.a)(a)),a}return Object(o.a)(t,e),Object(n.a)(t,[{key:"pushCurrentVersion",value:function(){var e={email:this.props.api.email,api_key:this.props.api.api_key,album_id:this.props.album.id,album_name:this.props.album.name};Object(u.c)(g.a+"/backend/database/album",e,"PUT").then().catch()}},{key:"handleNameChange",value:function(e){var t={id:this.props.album.id,name:e.target.value,image_count:this.props.album.image_count,visible_image_count:this.props.album.visible_image_count,title_image_id:this.props.album.title_image_id,image_id_to_index:this.props.album.image_id_to_index,images:this.props.album.images};this.props.updateAlbumState(this.props.index,t)}},{key:"handleNameKeyDown",value:function(e){13!==e.which&&9!==e.which||(e.preventDefault(),this.nameInputRef.current.blur())}},{key:"handleBlur",value:function(){this.pushCurrentVersion()}},{key:"processDelete",value:function(){var e=this;this.setState({deleting:!0});var t={email:this.props.api.email,api_key:this.props.api.api_key,album_id:this.props.album.id};Object(u.c)(g.a+"/backend/database/album",t,"DELETE").then((function(){setTimeout((function(){e.setState({deleteDialogOpen:!1,deleting:!1}),e.props.removeAlbumFromView(e.props.index)}),1e3)})).catch((function(){setTimeout((function(){e.setState({deleteDialogOpen:!1,deleting:!1})}),1e3)}))}},{key:"render",value:function(){var e,t=this,a=this.props.classes;return e=0===this.props.album.title_image_id?"https://storage.googleapis.com/i14-worlds-2021-gallery/default-images/default-image-1-medium.jpg":this.props.album.images[this.props.album.image_id_to_index[this.props.album.title_image_id]].filepath_medium,c.a.createElement(E.a,{elevation:3,className:a.card},c.a.createElement(d.b,{to:this.props.path},c.a.createElement(N.a,{className:a.cardMedia,image:e,alt:"Images inside "+this.props.album.name})),c.a.createElement(_.a,{className:a.cardContent},c.a.createElement(k.a,{fullWidth:!0,label:"Name",value:this.props.album.name,onChange:this.handleNameChange,onKeyDown:this.handleNameKeyDown,onBlur:this.handleBlur,inputRef:this.nameInputRef,className:a.textField}),c.a.createElement(C.a,{className:a.deleteIcon,onClick:function(){return t.setState({deleteDialogOpen:!0})}})),this.state.deleteDialogOpen&&c.a.createElement(O.a,{open:!0,"aria-labelledby":"alert-dialog-title"},c.a.createElement(S.a,{id:"alert-dialog-title"},"Do you really want to delete this album?"),c.a.createElement(j.a,null,c.a.createElement(y.a,{onClick:function(){return t.setState({deleteDialogOpen:!1})},disabled:this.state.deleting,color:"primary"},"Disagree"),c.a.createElement("div",{className:a.buttonSpinnerWrapper},c.a.createElement(y.a,{onClick:this.processDelete,disabled:this.state.deleting,autoFocus:!0},"Agree"),this.state.deleting&&c.a.createElement(v.a,{size:24,className:a.buttonProgress,color:"secondary"})))))}}]),t}(c.a.Component),D=w()((function(e){return{card:{position:"relative",cursor:"pointer",minWidth:250},cardMedia:{height:0,paddingTop:"66.666%"},cardContent:{padding:e.spacing(1),margin:0,"&:last-child":{padding:e.spacing(1)},display:"flex",position:"relative"},textField:{alignSelf:"flex-end",marginRight:e.spacing(4)},deleteIcon:{cursor:"pointer",position:"absolute",right:e.spacing(1),bottom:e.spacing(1)},buttonSpinnerWrapper:{position:"relative",display:"inline-flex",marginLeft:e.spacing(.5),marginRight:e.spacing(.5)},buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}}))(A),R=a(44),F=a(193),B=a.n(F),L=a(2),P=a(208),V=a.n(P),W=a(209),M=a.n(W),U=a(246),z=a.n(U),G=a(270),K=a.n(G),J=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(l.a)(t).call(this,e))).state={deleteDialogOpen:!1,deleting:!1},a.toggleTitleImage=a.toggleTitleImage.bind(Object(r.a)(a)),a.toggleVisibility=a.toggleVisibility.bind(Object(r.a)(a)),a.processDelete=a.processDelete.bind(Object(r.a)(a)),a}return Object(o.a)(t,e),Object(n.a)(t,[{key:"toggleTitleImage",value:function(){var e=this.props.titleImage?0:this.props.image.id,t={email:this.props.api.email,api_key:this.props.api.api_key,album_id:this.props.albumId,album_title_image_id:e};this.props.updateTitleImageId(e),Object(u.c)(g.a+"/backend/database/album",t,"PUT").then().catch()}},{key:"toggleVisibility",value:function(){var e;e=1===this.props.image.visible?0:1;var t={description:this.props.image.description,timestamp:this.props.image.description,filepath_small:this.props.image.filepath_small,filepath_medium:this.props.image.filepath_medium,filepath_large:this.props.image.filepath_large,filepath_full:this.props.image.filepath_full,visible:e,id:this.props.image.id};this.props.updateState(this.props.index,t);var a={email:this.props.api.email,api_key:this.props.api.api_key,image_id:this.props.image.id,image_visible:e};Object(u.c)(g.a+"/backend/database/image",a,"PUT").then().catch()}},{key:"processDelete",value:function(){var e=this;this.setState({deleting:!0});var t={email:this.props.api.email,api_key:this.props.api.api_key,image_id:this.props.image.id};Object(u.c)(g.a+"/backend/database/image",t,"DELETE").then((function(){setTimeout((function(){e.setState({deleteDialogOpen:!1,deleting:!1}),e.props.removeImageFromView(e.props.index)}),1e3)})).catch((function(){setTimeout((function(){e.setState({deleteDialogOpen:!1,deleting:!1})}),1e3)}))}},{key:"render",value:function(){var e=this,t=this.props.classes;return c.a.createElement(E.a,{className:Object(L.a)(t.paper,1===this.props.image.visible?"":t.invisiblePaper),elevation:3},c.a.createElement(d.b,{to:"/admin/gallery/"+this.props.albumId+"/"+this.props.image.id},c.a.createElement(N.a,{className:t.cardMedia,image:this.props.image.filepath_medium,alt:this.props.image.description})),c.a.createElement(_.a,{className:t.cardContent},c.a.createElement("div",{className:t.visibilityBox},1===this.props.image.visible&&c.a.createElement(V.a,{onClick:this.toggleVisibility,className:t.visibilityIcon}),0===this.props.image.visible&&c.a.createElement(M.a,{onClick:this.toggleVisibility,className:t.visibilityIcon}),c.a.createElement(I.a,{className:t.visibilityText,variant:"body1"},this.props.image.visible?"Currently Visible":"Currently Invisible"))),c.a.createElement(C.a,{className:t.removeIcon,onClick:function(){return e.setState({deleteDialogOpen:!0})}}),this.props.titleImage&&c.a.createElement(z.a,{className:t.favoriteIcon,onClick:this.toggleTitleImage}),!this.props.titleImage&&c.a.createElement(K.a,{className:t.favoriteIcon,onClick:this.toggleTitleImage}),this.state.deleteDialogOpen&&c.a.createElement(O.a,{open:!0,"aria-labelledby":"alert-dialog-title"},c.a.createElement(S.a,{id:"alert-dialog-title"},"Do you really want to delete this image?"),c.a.createElement(j.a,null,c.a.createElement(y.a,{onClick:function(){return e.setState({deleteDialogOpen:!1})},disabled:this.state.deleting,color:"primary"},"Disagree"),c.a.createElement("div",{className:t.buttonSpinnerWrapper},c.a.createElement(y.a,{onClick:this.processDelete,disabled:this.state.deleting,autoFocus:!0},"Agree"),this.state.deleting&&c.a.createElement(v.a,{size:24,className:t.buttonProgress,color:"secondary"})))))}}]),t}(c.a.Component),H=w()((function(e){return{paper:{position:"relative"},invisiblePaper:{backgroundColor:"rgb(230, 230, 230)"},cardMedia:{height:0,paddingTop:"66.666%"},cardContent:{padding:e.spacing(1),margin:0,"&:last-child":{padding:e.spacing(1)},display:"flex",position:"relative"},visibilityBox:{display:"flex",justifyContent:"left",alignItems:"center",flexDirection:"row",margin:e.spacing(1)},visibilityIcon:{marginRight:e.spacing(2),cursor:"pointer",alignSelf:"flex-start"},visibilityText:{alignSelf:"flex-start"},removeIcon:{cursor:"pointer",position:"absolute",right:e.spacing(2),bottom:e.spacing(2)},favoriteIcon:{cursor:"pointer",position:"absolute",right:e.spacing(2),top:e.spacing(2),color:e.palette.desireMagenta.transparent80},buttonSpinnerWrapper:{position:"relative",display:"inline-flex",marginLeft:e.spacing(.5),marginRight:e.spacing(.5)},buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}}))(J),q=a(214),Q=a(204),X=a(207),Y=a(196),Z=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(l.a)(t).call(this,e))).albumId=a.props.match.params.albumId,a.imageId=a.props.match.params.imageId,a.state={description:void 0,timestamp:void 0,albumId:a.albumId,uploading:!1},a.descriptionInputRef=c.a.createRef(),a.processSave=a.processSave.bind(Object(r.a)(a)),a.getImageForm=a.getImageForm.bind(Object(r.a)(a)),a}return Object(o.a)(t,e),Object(n.a)(t,[{key:"processSave",value:function(){var e=this;console.log("Saving image"),this.setState({uploading:!0});var t={email:this.props.api.email,api_key:this.props.api.api_key,image_id:this.imageId},a=!1;void 0!==this.state.description&&(t.image_description=this.state.description,a=!0),void 0!==this.state.albumId&&(t.image_album_id=this.state.albumId,a=!0),void 0!==this.state.timestamp&&(t.image_timestamp=this.state.timestamp,a=!0),a?Object(u.c)(g.a+"/backend/database/image",t,"PUT").then((function(t){console.log("Saving image: Status = "+t),void 0!==e.state.albumId&&e.state.albumId!==e.albumId?window.open("/admin/gallery/"+e.state.albumId+"/"+e.imageId,"_self"):setTimeout((function(){void 0!==e.state.description&&(e.props.album.images[e.props.album.image_id_to_index[e.imageId]].description=e.state.description),void 0!==e.state.timestamp&&(e.props.album.images[e.props.album.image_id_to_index[e.imageId]].timestamp=e.state.timestamp),e.setState({description:void 0,timestamp:void 0,uploading:!1})}),1e3)})).catch((function(){console.log("Saving image: failed"),setTimeout((function(){e.setState({uploading:!1})}),1e3)})):this.setState({uploading:!1})}},{key:"getImageForm",value:function(e){var t=this,a=this.props.classes,i=c.a.createElement(b.a,{container:!0,spacing:1,justify:"center",alignItems:"center"},c.a.createElement(b.a,{item:!0,className:a.gridItem},c.a.createElement(q.a,{disabled:this.state.uploading,label:"Album",value:this.state.albumId,selectOptions:this.props.albumIdtoNameDict,onChange:function(e){return t.setState({albumId:e})},className:a.formControl})),c.a.createElement(b.a,{item:!0,className:a.gridItem},c.a.createElement(Q.a,{disabled:this.state.uploading,timestamp:void 0===this.state.timestamp?parseInt(e.timestamp):this.state.timestamp,updateTimestamp:function(e){return t.setState({timestamp:e})},className:a.datepicker})),c.a.createElement(b.a,{item:!0,className:a.gridItem},c.a.createElement(X.a,{disabled:this.state.uploading,timestamp:void 0===this.state.timestamp?parseInt(e.timestamp):this.state.timestamp,updateTimestamp:function(e){return t.setState({timestamp:e})},className:a.timepicker})),c.a.createElement(b.a,{item:!0,xs:12,className:a.gridItem},c.a.createElement(Y.a,{fullWidth:!0,className:a.descriptionInput,disabled:this.state.uploading,value:void 0===this.state.description?e.description:this.state.description,ref:this.descriptionInputRef,onChange:function(e){return t.setState({description:e})},onEnter:function(){return t.descriptionInputRef.current.blur()},onTab:function(){return t.descriptionInputRef.current.blur()},onEscape:function(){return t.descriptionInputRef.current.blur()},label:"Description"})));return c.a.createElement(c.a.Fragment,null,c.a.createElement(E.a,{elevation:3,className:a.card},c.a.createElement(N.a,{className:a.cardMedia,image:e.filepath_large,alt:e.filepath_large}),c.a.createElement(_.a,{className:a.cardContent},i)),c.a.createElement("div",{className:a.saveButtonWrapper},c.a.createElement("div",{className:a.buttonSpinnerWrapper},c.a.createElement(y.a,{variant:"contained",color:"secondary",disabled:this.state.uploading,onClick:this.processSave,className:a.button},"Save Changes"),this.state.uploading&&c.a.createElement(v.a,{size:24,className:a.buttonProgress,color:"secondary"}))))}},{key:"render",value:function(){var e,t,a=this.props.classes;return void 0!==this.props.album&&(e=this.props.album.images[this.props.album.image_id_to_index[this.imageId]]),t=void 0===this.props.album||void 0===e?c.a.createElement(c.a.Fragment,null,c.a.createElement(I.a,{variant:"h4",className:a.headline},"Nothing here ...")):c.a.createElement(c.a.Fragment,null,c.a.createElement(I.a,{variant:"h4",className:a.headline},"Edit Image"),this.getImageForm(e)),c.a.createElement("div",{className:"AdminGalleryPage"},c.a.createElement(d.b,{to:"/admin/gallery/"+this.albumId,onClick:function(){return R.animateScroll.scrollToTop({duration:300})}},c.a.createElement(B.a,{className:a.backIcon,color:"secondary"})),t)}}]),t}(c.a.Component),$=w()((function(e){return{backIcon:{position:"absolute",top:e.spacing(1),left:e.spacing(1)},headline:{paddingLeft:e.spacing(5),paddingRight:e.spacing(5),display:"block",textAlign:"center",marginBottom:e.spacing(4)},divider:{marginTop:e.spacing(2),marginBottom:e.spacing(4)},card:{position:"relative",width:"100%"},cardContent:{paddingTop:e.spacing(2),paddingRight:e.spacing(0),paddingBottom:e.spacing(2),paddingLeft:e.spacing(0),margin:0,"&:last-child":{paddingTop:e.spacing(2),paddingRight:e.spacing(0),paddingBottom:e.spacing(2),paddingLeft:e.spacing(0)},display:"flex",position:"relative"},hiddenInput:{display:"none"},selectButton:{color:e.palette.primary.main},gridItem:{display:"flex",position:"relative",alignItems:"center",justifyContent:"center",marginLeft:e.spacing(2),marginRight:e.spacing(2)},formControl:{minWidth:250,marginTop:e.spacing(1)},datepicker:{minWidth:250},timepicker:{minWidth:250},descriptionInput:{marginTop:e.spacing(1)},buttonSpinnerWrapper:{position:"relative",display:"inline-flex",marginTop:e.spacing(3),marginLeft:e.spacing(.5),marginRight:e.spacing(.5)},button:{color:"white",position:"relative",display:"inline-flex"},buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},saveButtonWrapper:{display:"flex",alignItems:"center",justifyContent:"center"},cardMedia:{height:0,paddingTop:"66.666%"}}}))(Object(p.h)(Z)),ee=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(l.a)(t).call(this,e))).albumId=a.props.match.params.albumId,a.getImageList=a.getImageList.bind(Object(r.a)(a)),a.updateState=a.updateState.bind(Object(r.a)(a)),a.removeImageFromView=a.removeImageFromView.bind(Object(r.a)(a)),a}return Object(o.a)(t,e),Object(n.a)(t,[{key:"getImageList",value:function(e){var t=this,a=this.props.classes;if(0===e.images.length)return c.a.createElement(I.a,{variant:"h6",className:a.headline},"No images ...");var i=e.images.map((function(a,i){return c.a.createElement(b.a,{item:!0,xs:12,sm:6,md:4,lg:4,xl:4,key:i},c.a.createElement(H,{albumId:t.albumId,titleImage:e.title_image_id===a.id,updateTitleImageId:function(a){return t.props.updateTitleImageId(e.id,a)},image:a,index:i,updateState:t.updateState,api:t.props.api,removeImageFromView:t.removeImageFromView}))}));return c.a.createElement(b.a,{container:!0,spacing:2},i)}},{key:"updateState",value:function(e,t){this.props.updateImageState(this.albumId,e,t)}},{key:"removeImageFromView",value:function(e){this.props.removeImageFromView(this.albumId,e)}},{key:"render",value:function(){var e,t=this.props.classes,a=this.props.getAlbumFromId(this.albumId);if(void 0===a)e=c.a.createElement(c.a.Fragment,null,c.a.createElement(I.a,{variant:"h4",className:t.headline},"Nothing here ..."));else{var i=a.name;0===i.length&&(i="No Title"),e=c.a.createElement(c.a.Fragment,null,c.a.createElement(I.a,{variant:"h4",className:t.headline},i),this.getImageList(a))}return c.a.createElement("div",{className:"AdminGalleryPage"},c.a.createElement(p.d,null,c.a.createElement(p.b,{exact:!0,path:"/admin/gallery/"+this.albumId},c.a.createElement(d.b,{to:"/admin/gallery",onClick:function(){return R.animateScroll.scrollToTop({duration:300})}},c.a.createElement(B.a,{className:t.backIcon,color:"secondary"})),e),c.a.createElement(p.b,{path:"/admin/gallery/:albumId/:imageId"},c.a.createElement($,{api:this.props.api,albumIds:this.props.albumIds,albumIdtoNameDict:this.props.albumIdtoNameDict,album:a,triggerReload:this.props.triggerReload}))))}}]),t}(c.a.Component),te=w()((function(e){return{backIcon:{position:"absolute",top:e.spacing(1),left:e.spacing(1)},headline:{paddingLeft:e.spacing(5),paddingRight:e.spacing(5),display:"block",textAlign:"center",marginBottom:e.spacing(4)},buttonRow:{display:"flex",position:"relative",alignItems:"center",justifyContent:"center"},buttonSpinnerWrapper:{position:"relative",display:"inline-flex",marginLeft:e.spacing(.5),marginRight:e.spacing(.5)},divider:{marginTop:e.spacing(2),marginBottom:e.spacing(2)},card:{position:"relative",cursor:"pointer",minWidth:250},cardMedia:{height:0,paddingTop:"66.666%"},cardContent:{padding:e.spacing(1),margin:0,"&:last-child":{padding:e.spacing(1)},display:"flex",position:"relative"},textField:{alignSelf:"flex-end",marginRight:e.spacing(4)},deleteIcon:{cursor:"pointer",position:"absolute",right:e.spacing(1),bottom:e.spacing(1)},visibilityBox:{display:"flex",justifyContent:"left",alignItems:"center",flexDirection:"row",marginTop:e.spacing(2)},visibilityIcon:{marginRight:e.spacing(2),cursor:"pointer",alignSelf:"flex-start"},visibilityText:{alignSelf:"flex-start"},removeIcon:{cursor:"pointer",position:"absolute",right:e.spacing(2),bottom:e.spacing(2)}}}))(Object(p.h)(ee)),ae=a(271),ie=a.n(ae),ne=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(l.a)(t).call(this,e))).state={uploading:!1,description:"",timestamp:Math.round(Date.now()/1e3),albumId:a.props.albumIds[0],file:void 0,visible:1},a.descriptionInputRef=c.a.createRef(),a.processUpload=a.processUpload.bind(Object(r.a)(a)),a.getUploadForm=a.getUploadForm.bind(Object(r.a)(a)),a}return Object(o.a)(t,e),Object(n.a)(t,[{key:"processUpload",value:function(){var e=this;console.log("Uploading image"),this.setState({uploading:!0});var t=new FormData,a=document.getElementById("select-file-button").files;1===a.length?(t.append("email",this.props.api.email),t.append("api_key",this.props.api.api_key),t.append("image_file",a[0],a[0].name),t.append("image_timestamp",this.state.timestamp),t.append("image_description",this.state.description),t.append("image_album_id",this.state.albumId),t.append("image_visible",this.state.visible),Object(u.b)(g.a+"/backend/database/image",t).then((function(t){console.log("Uploading image: Status = "+t),e.setState({uploading:!1,description:"",file:void 0})})).catch((function(){console.log("Uploading image: failed"),e.setState({uploading:!1})}))):this.setState({uploading:!1})}},{key:"getUploadForm",value:function(){var e=this,t=this.props.classes,a=c.a.createElement(b.a,{container:!0,spacing:1,justify:"center",alignItems:"center"},c.a.createElement(b.a,{item:!0,xs:12,className:t.gridItem},c.a.createElement("input",{accept:"image/*",disabled:this.state.uploading,className:t.hiddenInput,id:"select-file-button",type:"file",onChange:function(t){return e.setState({file:t.target.value})}}),c.a.createElement("label",{htmlFor:"select-file-button"},c.a.createElement(y.a,{variant:"contained",color:"default",disabled:this.state.uploading,className:t.selectButton,startIcon:c.a.createElement(ie.a,{color:"primary"}),component:"span"},void 0===this.state.file?"Select File":this.state.file.split("\\").pop()))),c.a.createElement(b.a,{item:!0,className:t.gridItem},c.a.createElement(q.a,{label:"Album",disabled:this.state.uploading,value:this.state.albumId,selectOptions:this.props.albumIdtoNameDict,onChange:function(t){return e.setState({albumId:t})},className:t.formControl})),c.a.createElement(b.a,{item:!0,className:t.gridItem},c.a.createElement(Q.a,{disabled:this.state.uploading,timestamp:this.state.timestamp,updateTimestamp:function(t){return e.setState({timestamp:t})},className:t.datepicker})),c.a.createElement(b.a,{item:!0,className:t.gridItem},c.a.createElement(X.a,{disabled:this.state.uploading,timestamp:this.state.timestamp,updateTimestamp:function(t){return e.setState({timestamp:t})},className:t.timepicker})),c.a.createElement(b.a,{item:!0,xs:12,className:t.gridItem},c.a.createElement(Y.a,{fullWidth:!0,className:t.descriptionInput,disabled:this.state.uploading,value:this.state.description,ref:this.descriptionInputRef,onChange:function(t){return e.setState({description:t})},onEnter:function(){return e.descriptionInputRef.current.blur()},onTab:function(){return e.descriptionInputRef.current.blur()},onEscape:function(){return e.descriptionInputRef.current.blur()},label:"Description"})));return c.a.createElement(c.a.Fragment,null,c.a.createElement(E.a,{elevation:3,className:t.card},c.a.createElement(_.a,{className:t.cardContent},a)),c.a.createElement("div",{className:t.uploadButtonWrapper},c.a.createElement("div",{className:t.buttonSpinnerWrapper},c.a.createElement(y.a,{variant:"contained",color:"secondary",disabled:this.state.uploading,onClick:this.processUpload,className:t.button},"Upload Image"),this.state.uploading&&c.a.createElement(v.a,{size:24,className:t.buttonProgress,color:"secondary"}))))}},{key:"render",value:function(){var e=this,t=this.props.classes;return c.a.createElement("div",{className:"AdminGalleryPage"},c.a.createElement(d.b,{to:"/admin/gallery",onClick:function(){e.props.triggerReload(),R.animateScroll.scrollToTop({duration:300})}},c.a.createElement(B.a,{className:t.backIcon,color:"secondary"})),c.a.createElement(I.a,{variant:"h4",className:t.headline},"Image Upload"),c.a.createElement(h.a,{className:t.divider}),this.getUploadForm())}}]),t}(c.a.Component),se=w()((function(e){return{backIcon:{position:"absolute",top:e.spacing(1),left:e.spacing(1)},headline:{paddingLeft:e.spacing(5),paddingRight:e.spacing(5),display:"block",textAlign:"center",marginBottom:e.spacing(4)},divider:{marginTop:e.spacing(2),marginBottom:e.spacing(4)},card:{position:"relative",width:"100%"},cardContent:{paddingTop:e.spacing(2),paddingRight:e.spacing(0),paddingBottom:e.spacing(2),paddingLeft:e.spacing(0),margin:0,"&:last-child":{paddingTop:e.spacing(2),paddingRight:e.spacing(0),paddingBottom:e.spacing(2),paddingLeft:e.spacing(0)},display:"flex",position:"relative"},hiddenInput:{display:"none"},selectButton:{color:e.palette.primary.main},gridItem:{display:"flex",position:"relative",alignItems:"center",justifyContent:"center",marginLeft:e.spacing(2),marginRight:e.spacing(2)},formControl:{minWidth:250,marginTop:e.spacing(1)},datepicker:{minWidth:250},timepicker:{minWidth:250},descriptionInput:{marginTop:e.spacing(1)},buttonSpinnerWrapper:{position:"relative",display:"inline-flex",marginTop:e.spacing(3),marginLeft:e.spacing(.5),marginRight:e.spacing(.5)},button:{color:"white",position:"relative",display:"inline-flex"},buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},uploadButtonWrapper:{display:"flex",alignItems:"center",justifyContent:"center"}}}))(ne),le=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(l.a)(t).call(this,e))).state={loading:!0,albums:[],creatingAlbum:!1},a.updateTitleImageId=a.updateTitleImageId.bind(Object(r.a)(a)),a.triggerReload=a.triggerReload.bind(Object(r.a)(a)),a.getAlbumFromId=a.getAlbumFromId.bind(Object(r.a)(a)),a.getAlbumList=a.getAlbumList.bind(Object(r.a)(a)),a.createAlbum=a.createAlbum.bind(Object(r.a)(a)),a.updateAlbumState=a.updateAlbumState.bind(Object(r.a)(a)),a.updateImageState=a.updateImageState.bind(Object(r.a)(a)),a.removeAlbumFromView=a.removeAlbumFromView.bind(Object(r.a)(a)),a.removeImageFromView=a.removeImageFromView.bind(Object(r.a)(a)),a.getAlbumIds=a.getAlbumIds.bind(Object(r.a)(a)),a.getAlbumIdtoNameDict=a.getAlbumIdtoNameDict.bind(Object(r.a)(a)),a}return Object(o.a)(t,e),Object(n.a)(t,[{key:"componentDidMount",value:function(){this.triggerReload()}},{key:"updateTitleImageId",value:function(e,t){var a=this.state.albums;a[this.state.albumIdtoIndex[e]].title_image_id=t,this.setState({albums:a})}},{key:"triggerReload",value:function(){var e=this;console.log("Fetching album data");var t={email:this.props.api.email,api_key:this.props.api.api_key};Object(u.a)(g.a+"/backend/database/album",t).then((function(t){console.log("Fetching album data: successful"),e.setState({loading:!1,albums:JSON.parse(t).albums,albumIdtoIndex:JSON.parse(t).album_id_to_index})})).catch((function(){console.log("Fetching album data: failed"),e.setState({loading:!1})}))}},{key:"getAlbumFromId",value:function(e){return this.state.albums[this.state.albumIdtoIndex[e]]}},{key:"getAlbumList",value:function(){var e=this,t=this.props.classes;if(0===this.state.albums.length)return c.a.createElement(I.a,{variant:"h6",className:t.headline},"No albums ...");var a=this.state.albums.map((function(t,a){return c.a.createElement(b.a,{item:!0,xs:12,sm:6,md:4,lg:4,xl:4,key:a},c.a.createElement(D,{path:"/admin/gallery/"+t.id,album:t,api:e.props.api,index:a,updateAlbumState:e.updateAlbumState,removeAlbumFromView:e.removeAlbumFromView}))}));return c.a.createElement(b.a,{container:!0,spacing:2},a)}},{key:"createAlbum",value:function(){var e=this;console.log("Creating new album"),this.setState({creatingAlbum:!0});var t={email:this.props.api.email,api_key:this.props.api.api_key};Object(u.c)(g.a+"/backend/database/album",t,"POST").then((function(t){console.log("Creating new album: successful");var a={id:JSON.parse(t).new_album_id,name:"",image_count:0,visible_image_count:0,title_image_id:0,image_id_to_index:{},images:[]},i=e.state.albums;i.push(a);var n=e.state.albumIdtoIndex;n[JSON.parse(t).new_album_id]=e.state.albums.length,e.setState({creatingAlbum:!1,albums:i,albumIdtoIndex:n})})).catch((function(){console.log("Creating new album: failed"),e.setState({creatingAlbum:!1})}))}},{key:"updateAlbumState",value:function(e,t){var a=this.state.albums;a[e]=t,this.setState({albums:a})}},{key:"updateImageState",value:function(e,t,a){var i=this.state.albums;i[this.state.albumIdtoIndex[e]].images[t]=a,this.setState({albums:i})}},{key:"removeAlbumFromView",value:function(e){for(var t=[],a=0;a<this.state.albums.length;a++)a!==e&&t.push(this.state.albums[a]);this.setState({albums:t})}},{key:"removeImageFromView",value:function(e,t){for(var a=[],i=0;i<this.state.albums.length;i++)if(i===this.state.albumIdtoIndex[e]){for(var n=[],s=0;s<this.state.albums[i].images.length;s++)s!==t&&n.push(this.state.albums[i].images[s]);var l=this.state.albums[i];l.images=n,a.push(l)}else a.push(this.state.albums[i]);this.setState({albums:a})}},{key:"getAlbumIds",value:function(){for(var e=[],t=0;t<this.state.albums.length;t++)e.push(this.state.albums[t].id);return e}},{key:"getAlbumIdtoNameDict",value:function(){for(var e={},t=0;t<this.state.albums.length;t++)e[this.state.albums[t].id]=this.state.albums[t].name;return e}},{key:"render",value:function(){var e=this.props.classes;return c.a.createElement("div",{className:"AdminGalleryPage"},c.a.createElement(p.d,null,c.a.createElement(p.b,{exact:!0,path:"/admin/gallery/new"},this.state.loading&&c.a.createElement(f.a,{className:e.linearProgress,color:"secondary"}),!this.state.loading&&c.a.createElement(se,{api:this.props.api,albumIds:this.getAlbumIds(),albumIdtoNameDict:this.getAlbumIdtoNameDict(),triggerReload:this.triggerReload})),c.a.createElement(p.b,{exact:!0,path:"/admin/gallery"},c.a.createElement(I.a,{variant:"h4",className:e.headline},"Admin - Gallery"),this.state.loading&&c.a.createElement(f.a,{className:e.linearProgress,color:"secondary"}),!this.state.loading&&c.a.createElement("div",{className:e.root},c.a.createElement("div",{className:e.buttonRow},c.a.createElement("div",{className:e.buttonSpinnerWrapper},c.a.createElement(y.a,{variant:"contained",color:"secondary",disabled:this.state.creatingAlbum,onClick:this.createAlbum,className:e.button},"Add Album"),this.state.creatingAlbum&&c.a.createElement(v.a,{size:24,className:e.buttonProgress,color:"secondary"})),c.a.createElement("div",{className:e.buttonSpinnerWrapper},c.a.createElement(d.b,{to:"/admin/gallery/new"},c.a.createElement(y.a,{variant:"contained",color:"secondary",disabled:this.state.creatingAlbum,className:e.button},"Add Image")))),c.a.createElement(h.a,{className:e.divider}),this.getAlbumList())),c.a.createElement(p.b,{path:"/admin/gallery/:albumId"},this.state.loading&&c.a.createElement("div",{className:"AdminGalleryPage"},c.a.createElement(I.a,{variant:"h4",className:e.headline},"Gallery"),c.a.createElement(f.a,{className:e.linearProgress,color:"secondary"})),!this.state.loading&&c.a.createElement(te,{getAlbumFromId:this.getAlbumFromId,api:this.props.api,updateTitleImageId:this.updateTitleImageId,updateImageState:this.updateImageState,removeImageFromView:this.removeImageFromView,albumIds:this.getAlbumIds(),albumIdtoNameDict:this.getAlbumIdtoNameDict(),triggerReload:this.triggerReload}))))}}]),t}(c.a.Component);t.default=w()((function(e){return{headline:{display:"block",textAlign:"center",marginBottom:e.spacing(4)},linearProgress:{borderRadius:"2px"},root:{flexGrow:1},buttonRow:{display:"flex",position:"relative",alignItems:"center",justifyContent:"center"},buttonSpinnerWrapper:{position:"relative",display:"inline-flex",marginLeft:e.spacing(.5),marginRight:e.spacing(.5)},button:{color:"white",position:"relative",display:"inline-flex"},buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},divider:{marginTop:e.spacing(2),marginBottom:e.spacing(2)}}}))(le)}}]);
//# sourceMappingURL=10.90be8958.chunk.js.map